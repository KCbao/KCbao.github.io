I"<h2 id="tensor">Tensor</h2>

<p><strong>grad_fn</strong></p>

<p>Each variable has a <code class="language-plaintext highlighter-rouge">.grad_fn</code> attribute that references a function that has created a function (except for Tensors created by the user, these have <code class="language-plaintext highlighter-rouge">None</code> as <code class="language-plaintext highlighter-rouge">.grad_fn</code>).</p>

<p>For example, we create <code class="language-plaintext highlighter-rouge">x=torch.ones(2,2, requires_grad=True)</code>, then <code class="language-plaintext highlighter-rouge">x.grad_fn = None</code>, since we create the tensor <code class="language-plaintext highlighter-rouge">x</code> ourselves. And for <code class="language-plaintext highlighter-rouge">y=x+2</code>, then <code class="language-plaintext highlighter-rouge">y is tensor([[3,3]], grad_fn=&lt;AddBackward0&gt;)</code>.</p>

<p>When run <code class="language-plaintext highlighter-rouge">y_pred = model(X_test_tensor)</code>, get the following error
<code class="language-plaintext highlighter-rouge">RuntimeError: Expected object of scalar type Float but got scalar type Double for xxxxx</code>. 
Solve by <code class="language-plaintext highlighter-rouge">y_pred = model(X_test_tensor.float())</code>.</p>

<h2 id="watch-gpu-usage">Watch GPU usage</h2>
<p><code class="language-plaintext highlighter-rouge">watch -n 0.5 nvidia-smi</code></p>

<h2 id="multi-gpu-results-is-a-list">Multi-gpu, results is a list</h2>

<p>item 0 in the list, is results assigned to gpu 0
1, 1. 
etc</p>
:ET