<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <title>All about Pytorch</title>
  <meta name="description" content="Tensor">
  <meta name="author" content="Wei Wang">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="All about Pytorch">
  <meta name="twitter:description" content="Tensor">
  
  <meta property="og:type" content="article">
  <meta property="og:title" content="All about Pytorch">
  <meta property="og:description" content="Tensor">
  
  <!-- <link rel="icon" type="image/png" href="/assets/images/favicon.png" /> -->
  <!-- <link href="/assets/images/favicon.png" rel="shortcut icon" type="image/png"> -->
  
  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="http://localhost:4000/2020/11/Pytorch/">
  <link rel="alternate" type="application/rss+xml" title="Casie Bao" href="http://localhost:4000/feed.xml">
  
  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />
  
</head>


  <body>

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/assets/images/background.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="http://localhost:4000/#blog" title="前往 Casie Bao 的主页" class="blog-button"></a>
        <h1 class="panel-cover__title panel-title"><a href="http://localhost:4000/#blog" title="link to homepage for Casie Bao" class="blog-button">Casie Bao</a></h1>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">All the lights we cannot see</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        
        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="Visit blog" class="blog-button">Blog</a></li>
                
              </ul>
            </nav>
          </div>
          
          <div><nav class="cover-navigation navigation--social">
  <ul class="navigation">

  

  
  <!-- Github -->
  <li class="navigation__item">
    <a href="https://github.com/KCbao" title="@KCbao 的 Github" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>
  
  
  

  
  <!-- LinkedIn -->
  <li class="navigation__item">
    <a href="https://www.linkedin.com/in/anyi-casie-bao-78186aa7" title="@anyi-casie-bao-78186aa7" target="_blank">
      <i class='social fa fa-linkedin'></i>
      <span class="label">LinkedIn</span>
    </a>
  </li>
  

  

  <!-- RSS -->
  <li class="navigation__item">
    <a href="/feed.xml" rel="author" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>

  

  </ul>
</nav>
</div>
        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-disabled"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2020-11-10 10:18:12 -0800" itemprop="datePublished" class="post-meta__date date">2020-11-10</time> &#8226; <span class="post-meta__tags tags"></span>
    </div>
    <h1 class="post-title">All about Pytorch</h1>
  </header>

  <section class="post">
    <h2 id="tensor">Tensor</h2>

<p><strong>grad_fn</strong></p>

<p>Each variable has a <code class="language-plaintext highlighter-rouge">.grad_fn</code> attribute that references a function that has created a function (except for Tensors created by the user, these have <code class="language-plaintext highlighter-rouge">None</code> as <code class="language-plaintext highlighter-rouge">.grad_fn</code>).</p>

<p>For example, we create <code class="language-plaintext highlighter-rouge">x=torch.ones(2,2, requires_grad=True)</code>, then <code class="language-plaintext highlighter-rouge">x.grad_fn = None</code>, since we create the tensor <code class="language-plaintext highlighter-rouge">x</code> ourselves. And for <code class="language-plaintext highlighter-rouge">y=x+2</code>, then <code class="language-plaintext highlighter-rouge">y is tensor([[3,3]], grad_fn=&lt;AddBackward0&gt;)</code>.</p>

<p>When run <code class="language-plaintext highlighter-rouge">y_pred = model(X_test_tensor)</code>, get the following error
<code class="language-plaintext highlighter-rouge">RuntimeError: Expected object of scalar type Float but got scalar type Double for xxxxx</code>. 
Solve by <code class="language-plaintext highlighter-rouge">y_pred = model(X_test_tensor.float())</code>.</p>

<p><strong>Debug CUDA</strong></p>
<ul>
  <li>In command line, use <code class="language-plaintext highlighter-rouge">CUDA_LAUNCH_BLOCKING=1 python &lt;script&gt;.py</code></li>
</ul>

<p><strong>Watch GPU usage</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">watch -n 0.5 nvidia-smi</code></li>
</ul>

<h2 id="multi-gpu-results-is-a-list">Multi-gpu, results is a list</h2>

<p>item 0 in the list, is results assigned to gpu 0
1, 1. 
etc</p>

  </section>
</article>

<section class="read-more">
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">Latest Articles</span>
       <h2 class="post-list__post-title post-title"><a href="/2020/12/Leetcode/" title="link to Leetcode">Leetcode</a></h2>
       <p class="excerpt">Top Interview Questions (145 Questions)  主要思路：  知识点：  细节：2. Add two sums (medium)      主要思路： create a parent linked-list, and a child/dummy linked-list, dummy linked-list is moving ahead to update ...&hellip;</p>
       <div class="post-list__meta"><time datetime="2020-12-10 10:18:12 -0800" class="post-list__meta--date date">2020-12-10</time> &#8226; <span class="post-list__meta--tags tags"></span><a class="btn-border-small" href=/2020/12/Leetcode/>Read More</a></div>
   </div>
   
   
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">Eariler Articles</span>
       <h2 class="post-list__post-title post-title"><a href="/2020/11/argparse/" title="link to Python argparse and namespace">Python argparse and namespace</a></h2>
       <p class="excerpt">What is argparse?The Python argparse module defines what arguments it requires, and argparse will figure out how to parse those out of sys.argv. It also automatically generates help and usage messa...&hellip;</p>
       <div class="post-list__meta"><time datetime="2020-11-09 09:22:12 -0800" class="post-list__meta--date date">2020-11-09</time> &#8226; <span class="post-list__meta--tags tags"></span><a class="btn-border-small" href=/2020/11/argparse/>Read More</a></div>
   </div>
   
</section>


            <section class="footer">
    <footer></footer>
    
        <span class="footer__copyright"> &copy; 2021 Casie Bao</span>
    </footer>
</section>

        </div>
    </div>
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript" src="/js/main.js"></script>



    
  </body>

</html>
